<%
  save_button_help_text = "save button help text"
  submit_button_help_text = "submit button help text"
%>


<%= submit_tag('Save',  title: save_button_help_text, class: 'btn btn-primary', name:'save_button', id: 'save-button',
               disabled: false) %>

<%= submit_tag('Submit', title: submit_button_help_text, :onclick => "return previewStages();",
               class: 'btn btn-primary', name: 'submit_button', id: 'studyhub_resource_submit_btn', disabled: false) %>

<%= image_tag("ajax-loader.gif", :id => 'permissions_spinner', :style => 'display: none') -%>
<div id="permissions-preview-wrapper"></div>



<script type="text/javascript">

    function previewStages() {
            $j('#permissions_spinner').show();
            $j.ajax({
                type: "POST",
            url: '<%= preview_stages_studyhub_resources_path -%>',
                data: {id: <%= @studyhub_resource.id %>},
                success: function (result) {
                    $j('#permissions-preview-wrapper').html(result);
                    $j('#preview_permissions').modal('show');
                    //this is to prevent other modal boxes being closes, if this is the child of another
                    $j('#preview_permissions').on('click', '[data-dismiss="modal"]', function (e) { e.stopPropagation(); });
           },
                error: function () {
                alert('Sorry, an error has occurred.');
              },
         complete: function () {
               $j('#permissions_spinner').hide();
            }
          });
      return false;
   }
</script>






